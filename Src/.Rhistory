dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent and Orbit
dummy_data <- dummy_data[,c(1:2,6:13,15:29)]
View(dummy_data)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" , "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
View(dummy_data)
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
summary(data)
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
set.seed(123)
data <- data[sample(nrow(data)), ]
# Installa il pacchetto Hmisc se non è già installato
#install.packages("Hmisc")
# Carica le librerie
library(Hmisc)
# Calcola la correlazione tra variabile numerica e categorica
cor_test_result <-
rcorr(
cbind(
data$`Longitude of GEO`,
data$Perigee,
data$Apogee,
data$Eccentricity,
data$Inclination,
data$Period,
data$Mass
),
type = "spearman"
)
# Estrai la tabella di correlazione
correlation_table <- cor_test_result$r
# Aggiungi i nomi delle variabili come colonna e riga
row.names(correlation_table) <- colnames(correlation_table) <-c('Longitude of GEO','Perigee','Apogee','Eccentricity','Inclination','Period','Mass')
# Stampa la tabella
print(correlation_table)
data <- data[,c(-8,-11)]
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
View(dummy_data)
dummy_data <- dummy_data[,c(1:2,6:15,17:31)]
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" , "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
summary(cox1)
View(dummy_data)
View(data)
names(dummy_data)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
summary(cox1)
covariates[9]
dummy_data$Purpose_Navigation
hist(dummy_data$Purpose_Navigation)
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`, dummy_data$Perigee, dummy_data$Eccentricity, dummy_data$Inclination, dummy_data$Mass, dummy_data$Users_Commercial, dummy_data$Users_Government, dummy_data$Users_Military, dummy_data$`Purpose_Earth Observation`, strata(dummy_data$Purpose_Navigation), dummy_data$Orbit_GEO, dummy_data$Orbit_LEO, dummy_data$Orbit_MEO, dummy_data$Continent_Americas, dummy_data$Continent_Asia, dummy_data$Continent_Europe, dummy_data$Continent_Multinational, dummy_data$Continent_Oceania)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`, dummy_data$Perigee, dummy_data$Eccentricity, dummy_data$Inclination, dummy_data$Mass, dummy_data$Users_Commercial, dummy_data$Users_Government, dummy_data$Users_Military, dummy_data$`Purpose_Earth Observation`, strata(dummy_data$Purpose_Navigation), dummy_data$Orbit_GEO, dummy_data$Orbit_LEO, dummy_data$Orbit_MEO, dummy_data$Continent_Americas, dummy_data$Continent_Asia, dummy_data$Continent_Europe, dummy_data$Continent_Multinational, dummy_data$Continent_Oceania, data = dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`, dummy_data$Perigee, dummy_data$Eccentricity, dummy_data$Inclination, dummy_data$Mass, dummy_data$Users_Commercial, dummy_data$Users_Government, dummy_data$Users_Military, dummy_data$`Purpose_Earth Observation`, strata(dummy_data$Purpose_Navigation), dummy_data$Orbit_GEO, dummy_data$Orbit_LEO, dummy_data$Orbit_MEO, dummy_data$Continent_Americas, dummy_data$Continent_Asia, dummy_data$Continent_Europe, dummy_data$Continent_Multinational, dummy_data$Continent_Oceania, data = dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ `Longitude of GEO`, Perigee, Eccentricity,  Inclination,  Mass,  Users_Commercial,  Users_Government,  Users_Military,  `Purpose_Earth Observation`, strata( Purpose_Navigation),  Orbit_GEO,  Orbit_LEO,  Orbit_MEO,  Continent_Americas,  Continent_Asia,  Continent_Europe,  Continent_Multinational,  Continent_Oceania, data = dummy_data)
View(dummy_data)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ `Longitude of GEO`, Perigee, Eccentricity,  Inclination,  Mass,  Users_Commercial, Users_Government,  Users_Military,  `Purpose_Earth Observation`, strata( Purpose_Navigation),  Orbit_GEO,  Orbit_LEO,  Orbit_MEO,  Continent_Americas,  Continent_Asia,  Continent_Europe,  Continent_Multinational,  Continent_Oceania, data =dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ "Longitude of GEO", "Perigee", "Eccentricity",  "Inclination",  "Mass",  Users_Commercial, Users_Government,  Users_Military,  `Purpose_Earth Observation`, strata( Purpose_Navigation),  Orbit_GEO,  Orbit_LEO,  Orbit_MEO,  Continent_Americas,  Continent_Asia,  Continent_Europe,  Continent_Multinational,  Continent_Oceania, data =dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ "Longitude of GEO", "Perigee", "Eccentricity",  "Inclination",  "Mass",  Users_Commercial, "Users_Government",  Users_Military,  `Purpose_Earth Observation`, strata( Purpose_Navigation),  Orbit_GEO,  Orbit_LEO,  Orbit_MEO,  Continent_Americas,  Continent_Asia,  Continent_Europe,  Continent_Multinational,  Continent_Oceania, data =dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ "Longitude of GEO", "Perigee", "Eccentricity",  "Inclination",  "Mass",  "Users_Commercial", "Users_Government",  Users_Military,  `Purpose_Earth Observation`, strata( Purpose_Navigation),  Orbit_GEO,  Orbit_LEO,  Orbit_MEO,  Continent_Americas,  Continent_Asia,  Continent_Europe,  Continent_Multinational, Continent_Oceania, data =dummy_data)
cox1 <- coxph(Surv(time+status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Eccentricity+ dummy_data$Inclination+ dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ dummy_data$Orbit_MEO+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Eccentricity+ dummy_data$Inclination+ dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ dummy_data$Orbit_MEO+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox1)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Eccentricity+ dummy_data$Inclination+ dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ srata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
cox1 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Eccentricity+ dummy_data$Inclination+ dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox1)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox2 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Inclination+ dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox2)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox3 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox2)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox3 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ dummy_data$`Purpose_Earth Observation`+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox3)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox3 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox3)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox4 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+ dummy_data$Users_Military+ strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox4)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox5 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+  strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+ dummy_data$Orbit_LEO+ strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox5)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox6 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+  strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+  strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox6)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox7 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+  strata(dummy_data$Purpose_Navigation)+ dummy_data$Orbit_GEO+  strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational,  data = dummy_data)
summary(cox7)
test <- cox.zph(cox6)
test
# Residui
ggcoxdiagnostics(cox6, type = "scaledsch")
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox7 <- coxph(Surv(time,status == 'retired') ~ dummy_data$`Longitude of GEO`+ dummy_data$Perigee + dummy_data$Mass+ dummy_data$Users_Commercial+ dummy_data$Users_Government+  strata(dummy_data$Purpose_Navigation)+ strata(dummy_data$Orbit_GEO)+  strata(dummy_data$Orbit_MEO)+ dummy_data$Continent_Americas+ dummy_data$Continent_Asia+ dummy_data$Continent_Europe+ dummy_data$Continent_Multinational+ dummy_data$Continent_Oceania,  data = dummy_data)
summary(cox7)
test <- cox.zph(cox7)
test
# Residui
ggcoxdiagnostics(cox7, type = "scaledsch")
ggcoxdiagnostics(cox7, type = "deviance")
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
set.seed(0)
data <- data[sample(nrow(data)), ]
#install.packages("fastDummies")
library(fastDummies)
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent and Orbit
dummy_data <- dummy_data[,c(1:2,6:17,19:33)]
library(glmnet)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <-
c(
"Longitude of GEO" ,
"Perigee" ,
"Apogee",
"Eccentricity" ,
"Inclination",
"Period",
"Mass",
"Users_Commercial",
"Users_Government",
"Users_Military",
"Purpose_Earth Observation",
"Purpose_Navigation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Orbit_GEO",
"Orbit_LEO",
"Orbit_MEO",
"Continent_Americas",
"Continent_Asia",
"Continent_Europe",
"Continent_Multinational",
"Continent_Oceania"
)
n_coef = length(covariates)
lambda.grid <- 10^seq(2, -5 ,length = 100)
# Adatta un modello di regressione di Cox penalizzato usando glmnet
# alpha = 1 per la penalizzazione L2 (Ridge)
# alpha = 0 per la penalizzazione L1 (Lasso)
cox_model <- cv.glmnet(x = as.matrix(dummy_data[,covariates]), y = Surv(time,status == 'retired'), family = "cox", alpha = 0.2, lambda = lambda.grid)
# PROVA A CAMBIARE VALORE DI ALPHA ---> ELASTIC NET FORSE è MEGLIO
print(cox_model)
bestlambda <- cox_model$lambda.min # con lasso lambda è quasi zero
plot(cox_model)
abline(v=log(bestlambda), lty=1)
fitAtLmin <- glmnet(x = as.matrix(dummy_data[,covariates]),  y = Surv(time,status == 'retired') ,family="cox",lambda=bestlambda)
coef <- coef(fitAtLmin)
coef
library(glmnet)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <-
c(
"Longitude of GEO" ,
"Perigee" ,
"Apogee",
"Eccentricity" ,
"Inclination",
"Period",
"Mass",
"Users_Commercial",
"Users_Government",
"Users_Military",
"Purpose_Earth Observation",
"Purpose_Navigation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Orbit_GEO",
"Orbit_LEO",
"Orbit_MEO",
"Continent_Americas",
"Continent_Asia",
"Continent_Europe",
"Continent_Multinational",
"Continent_Oceania"
)
n_coef = length(covariates)
lambda.grid <- 10^seq(2, -5 ,length = 100)
# Adatta un modello di regressione di Cox penalizzato usando glmnet
# alpha = 1 per la penalizzazione L2 (Ridge)
# alpha = 0 per la penalizzazione L1 (Lasso)
cox_model <- cv.glmnet(x = as.matrix(dummy_data[,covariates]), y = Surv(time,status == 'retired'), family = "cox", alpha = 0.6, lambda = lambda.grid)
# PROVA A CAMBIARE VALORE DI ALPHA ---> ELASTIC NET FORSE è MEGLIO
print(cox_model)
bestlambda <- cox_model$lambda.min # con lasso lambda è quasi zero
plot(cox_model)
abline(v=log(bestlambda), lty=1)
fitAtLmin <- glmnet(x = as.matrix(dummy_data[,covariates]),  y = Surv(time,status == 'retired') ,family="cox",lambda=bestlambda)
coef <- coef(fitAtLmin)
coef
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
summary(data)
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
data$Continent[which(data$Continent == 'Afrrica')] == 'Others'
data$Continent[which(data$Continent == 'Afrrica')] = 'Others'
data$Continent[which(data$Continent == 'Afrrica')]
https://glmnet.stanford.edu/articles/Coxnet.html
which(data$Continent == 'Afrrica')
data$Continent[which(data$Continent == 'Africa')] = 'Others'
which(data$Continent == 'Africa')
data$Continent[which(data$Continent == Africa)] = 'Others'
data$Continent[data$Continent == 'Africa'] <- 'Others'
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
summary(data)
data$Continent[data$Continent == 'Africa'] <- 'Others'
data$Continent[data$Continent == 'Africa'] <- 'Others'
data$Continent[data$Continent == 'Ocenaia'] <- 'Others'
data$Continent[data$Continent == 'Multinational'] <- 'Others'
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
data$Continent[data$Continent == 'Africa'] <- 'Others'
data$Continent[data$Continent == 'Oceania'] <- 'Others'
data$Continent[data$Continent == 'Multinational'] <- 'Others'
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
set.seed(123)
data <- data[sample(nrow(data)), ]
# Installa il pacchetto Hmisc se non è già installato
#install.packages("Hmisc")
# Carica le librerie
library(Hmisc)
# Calcola la correlazione tra variabile numerica e categorica
cor_test_result <-
rcorr(
cbind(
data$`Longitude of GEO`,
data$Perigee,
data$Apogee,
data$Eccentricity,
data$Inclination,
data$Period,
data$Mass
),
type = "spearman"
)
# Estrai la tabella di correlazione
correlation_table <- cor_test_result$r
# Aggiungi i nomi delle variabili come colonna e riga
row.names(correlation_table) <- colnames(correlation_table) <-c('Longitude of GEO','Perigee','Apogee','Eccentricity','Inclination','Period','Mass')
# Stampa la tabella
print(correlation_table)
#install.packages("fastDummies")
library(fastDummies)
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent and Orbit
dummy_data <- dummy_data[,c(1:2,6:15,17:31)]
View(dummy_data)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Multinational", "Continent_Oceania")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Others")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c( "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development", "Continent_Asia", "Continent_Europe", "Continent_Others")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
summary(cox1)
View(dummy_data)
table(dummy_data$Purpose_Navigation)
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/TrainingSet.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
summary(data)
data$Continent[data$Continent == 'Africa'] <- 'Others'
data$Continent[data$Continent == 'Oceania'] <- 'Others'
data$Continent[data$Continent == 'Multinational'] <- 'Others'
data$Country <- factor(data$Country, ordered = F)
print('Country')
table(data$Country)
data$Continent <- factor(data$Continent, ordered = F)
print('Continent')
table(data$Continent)
data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)
data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)
data$Orbit <- factor(data$Orbit, ordered = F)
print('Class of Orbit')
table(data$Orbit)
data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
data <- data[,c(-8,-11)]
#install.packages("fastDummies")
library(fastDummies)
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = FALSE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = FALSE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = FALSE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = FALSE)
View(dummy_data)
dummy_data <- dummy_data[,c(1:2,6:15,17:33)]
names(dummy_data)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <- c(  "Longitude of GEO", "Perigee" ,  "Eccentricity", "Inclination", "Mass", "Users_Civil", "Users_Commercial", "Users_Government", "Users_Military", "Purpose_Communications", "Purpose_Earth Observation", "Purpose_Navigation", "Purpose_Space Science", "Purpose_Technology Development","Orbit_Elliptical", "Orbit_GEO", "Orbit_LEO", "Continent_Americas", "Continent_Asia", "Continent_Europe", "Continent_Others")
n_coef <- length(covariates)
cox1 <- coxph(Surv(time,status == 'retired') ~ ., data = dummy_data[,covariates])
summary(cox1)
table(dummy_data$Users_Military)
table(dummy_data$`Purpose_Earth Observation`)
table(dummy_data$`Purpose_Technology Development`)
