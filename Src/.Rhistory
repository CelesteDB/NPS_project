'Pe.disc_medium'
)
cox4 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox4)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Earth Observation',
'Purpose_Space Science',
'Purpose_Technology Development',
'Orbit_GEO',
'Continent_Americas',
'Continent_Asia',
'Continent_Multinational',
'Mass.disc_heavy',
'Inc.disc_medium',
'Pe.disc_medium'
)
cox5 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox5)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Earth Observation',
'Purpose_Space Science',
'Purpose_Technology Development',
'Orbit_GEO',
'Continent_Americas',
'Continent_Asia',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox6 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox6)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Earth Observation',
'Purpose_Space Science',
'Purpose_Technology Development',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox7 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox7)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Purpose_Technology Development',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox8 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox8)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox9)
test <- cox.zph(cox9)
test
# Residui
ggcoxdiagnostics(cox9, type = "scaledsch")
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <- coxph(Surv(time, Status == 'retired') ~ 'Longitude of GEO' + Users_Commercial + Users_Government + 'Purpose_Space Science' +
strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy + Pe.disc_medium , data = dummy_data[,variable_sel])
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$'Longitude of GEO' + Users_Commercial + Users_Government + dummy_data$'Purpose_Space                                         Science' + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + Users_Government + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
summary(cox9)
test <- cox.zph(cox9)
test
# Residui
ggcoxdiagnostics(cox9, type = "scaledsch")
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + strata(Users_Government) + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
summary(cox9)
test <- cox.zph(cox9)
test
# Residui
ggcoxdiagnostics(cox9, type = "scaledsch")
library(readxl)
data <- read_excel("../Dataset/JoinDatasets.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
summary(data)
set.seed(0)
data <- data[sample(nrow(data)), ]
#install.packages("fastDummies")
library(fastDummies)
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent and Orbit
dummy_data <- dummy_data[,c(1:2,6:17,19:33)]
library(glmnet)
time <- dummy_data$`Effective Lifetime`
status <- dummy_data$Status
covariates <-
c(
"Longitude of GEO" ,
"Perigee" ,
"Apogee",
"Eccentricity" ,
"Inclination",
"Period",
"Mass",
"Users_Commercial",
"Users_Government",
"Users_Military",
"Purpose_Earth Observation",
"Purpose_Navigation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Orbit_GEO",
"Orbit_LEO",
"Orbit_MEO",
"Continent_Americas",
"Continent_Asia",
"Continent_Europe",
"Continent_Multinational",
"Continent_Oceania"
)
n_coef = length(covariates)
lambda.grid <- 10^seq(2, -5 ,length = 100)
# Adatta un modello di regressione di Cox penalizzato usando glmnet
# alpha = 1 per la penalizzazione L2 (Ridge)
# alpha = 0 per la penalizzazione L1 (Lasso)
cox_model <- cv.glmnet(x = as.matrix(dummy_data[,covariates]), y = Surv(time,status == 'retired'), family = "cox", alpha = 0.2, lambda = lambda.grid)
# PROVA A CAMBIARE VALORE DI ALPHA ---> ELASTIC NET FORSE è MEGLIO
print(cox_model)
bestlambda <- cox_model$lambda.min # con lasso lambda è quasi zero
plot(cox_model)
abline(v=log(bestlambda), lty=1)
fitAtLmin <- glmnet(x = as.matrix(dummy_data[,covariates]),  y = Surv(time,status == 'retired') ,family="cox",lambda=bestlambda)
coef <- coef(fitAtLmin)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Inclination",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Earth Observation",
"Purpose_Navigation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas",
"Continent_Asia",
"Continent_Multinational"
)
cox1 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox1)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Inclination",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Earth Observation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas",
"Continent_Asia",
"Continent_Multinational"
)
cox2 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox2)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Earth Observation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas",
"Continent_Asia",
"Continent_Multinational"
)
cox3 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox3)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Earth Observation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas",
"Continent_Multinational"
)
cox4 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox4)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Earth Observation",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas"    )
cox5 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox5)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Space Science",
"Purpose_Technology Development",
"Continent_Americas"    )
cox6 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox6)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Space Science",
"Continent_Americas"    )
cox7 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox7)
test <- cox.zph(cox7)
test
# Residui
ggcoxdiagnostics(cox7, type = "scaledsch")
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <-c(  # con coef != 0
"Perigee",
"Apogee",
"Mass",
"Users_Commercial",
"Users_Government",
"Purpose_Space Science",
"Continent_Americas"    )
cox7 <- coxph(Surv(time, Status == 'retired') ~ strata(Perigee) + Apogee + Mass +Users_Commercial+  Users_Government +
dummy_data$`Purpose_Earth Observation` + Continent_Americas, data = dummy_data)
summary(cox7)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + strata(Users_Government) + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
#install.packages("fastDummies")
library(fastDummies)
# USERS : Levels: Civil Commercial Government Military
dummy_data <- dummy_cols(data, select_columns = "Users", remove_first_dummy = TRUE)
# PURPOSE : Levels: Communications Earth Observation Navigation Space Science Technology Development
dummy_data <- dummy_cols(dummy_data, select_columns = "Purpose", remove_first_dummy = TRUE)
# ORBIT : Levels: Elliptical GEO LEO MEO
dummy_data <- dummy_cols(dummy_data, select_columns = "Orbit", remove_first_dummy = TRUE)
# CONTINENT: Levels: Africa Americas Asia Europe Multinational Oceania
dummy_data <- dummy_cols(dummy_data, select_columns = "Continent", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent and Orbit
dummy_data <- dummy_data[,c(1:2,6:17,19:33)]
View(dummy_data)
# MASS: Levels: light heavy
dummy_data <- dummy_cols(dummy_data, select_columns = "Mass.disc", remove_first_dummy = TRUE)
Massa.disc <- cut(data$Mass, breaks=c(0, 1000, Inf), labels=c("light", "heavy"))
dummy_data$Mass.disc <- Massa.disc
Per.disc <- cut(data$Period, breaks=c(0, 500, 1000, Inf), labels=c("short", "medium", "long"))
dummy_data$Per.disc <- Per.disc
Inc.disc <- cut(data$Inclination, breaks=c(-Inf, 40, 70, Inf), labels=c("low", "medium", "high"))
dummy_data$Inc.disc <- Inc.disc
Ap.disc <- cut(data$Apogee, breaks=c(0, 25000, Inf), labels=c("low", "high"))
dummy_data$Ap.disc <- Ap.disc
Pe.disc <- cut(data$Perigee, breaks=c(0, 5000, 25000, Inf), labels=c("low","medium","high"))
dummy_data$Pe.disc <- Pe.disc
# MASS: Levels: light heavy
dummy_data <- dummy_cols(dummy_data, select_columns = "Mass.disc", remove_first_dummy = TRUE)
# PERIOD: Levels: short medium long
dummy_data <- dummy_cols(dummy_data, select_columns = "Per.disc", remove_first_dummy = TRUE)
# INCLINATION: Levels: low medium high
dummy_data <- dummy_cols(dummy_data, select_columns = "Inc.disc", remove_first_dummy = TRUE)
# PERIGEE: Levels: low medium high
dummy_data <- dummy_cols(dummy_data, select_columns = "Pe.disc", remove_first_dummy = TRUE)
# APOGEE: Levels: low high
dummy_data <- dummy_cols(dummy_data, select_columns = "Ap.disc", remove_first_dummy = TRUE)
# dataset senza Purpose, Users, Continent, Orbit, Mass, Period,  Inclination, Apogee and Perigee
dummy_data <- dummy_data[,c(1:3,6,9:12, 15:29, 35:42)]
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + strata(Users_Government) + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
summary(cox9)
test <- cox.zph(cox9)
test
# Residui
ggcoxdiagnostics(cox9, type = "scaledsch")
ggforest(cox9, data=dummy_data)
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + Users_Government + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
summary(cox9)
ggforest(cox9, data=dummy_data)
ggforest(cox9, data=dummy_data[,variable_sel])
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <- coxph(Surv(time, Status == 'retired') ~ . , data = dummy_data[,variable_sel])
summary(cox9)
ggforest(cox9, data=dummy_data[,variable_sel])
plot(predict(cox9), residuals(cox9, type='martingale'),
xlab='Fitted values', ylab='Martingale residuals', main='Residual Plot', las=1)
# Add a line for residual=0
abline(h=0, col='red')
# Fit a smoother for the points
lines(smooth.spline(predict(cox9), residuals(cox9, type='martingale')), col='blue')
ggcoxdiagnostics(cox9, type = "deviance")
time <- dummy_data$`Effective Lifetime`
Status <- dummy_data$Status
variable_sel <- c(
# con coef != 0
'Longitude of GEO',
'Users_Commercial',
'Users_Government',
'Purpose_Space Science',
'Orbit_GEO',
'Continent_Americas',
'Continent_Multinational',
'Mass.disc_heavy',
'Pe.disc_medium'
)
cox9 <-
coxph(
Surv(time, Status == 'retired') ~ dummy_data$`Longitude of GEO` + Users_Commercial + strata(Users_Government) + dummy_data$`Purpose_Space Science` + strata(Orbit_GEO) + Continent_Americas + Continent_Multinational + Mass.disc_heavy +                                           Pe.disc_medium , data = dummy_data)
summary(cox9)
test <- cox.zph(cox9)
test
# Residui
ggcoxdiagnostics(cox9, type = "scaledsch")
ggcoxdiagnostics(cox9, type = "deviance")
```{r}
es <- data.frame(
'Longitude of GEO' = 0,
'Users_Commercial' = 1,
'Users_Government'= 0,
'Purpose_Space Science' = 1,
'Orbit_GEO' = 0,
'Continent_Americas'= 1,
'Continent_Multinational' = 0,
'Mass.disc_heavy' = 1,
'Pe.disc_medium' = 0
)
new_data <- with(ldummy_data, )
es
View(es)
fit
fit <- survfit(cox9, newdata = es)
es <- data.frame(
Longitude of GEO = 0,
fit <- survfit(cox9, newdata = dummy_data)
fit
print(fit)
median_survival_time <- quantile(fit, probs = 0.5)
print(median_survival_time)
new_dataset <-
fit
?median
plot(fit)
#print(fit) # qui mi dà le nuove hazard function -> funzione del rischio di morte
