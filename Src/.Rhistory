income.grid=with(Prestige, seq(range(income)[1],range(income)[2],by=10))
preds=predict(m_cut,list(income=income.grid),se=T)
se.bands=cbind(preds$fit +2* preds$se.fit ,preds$fit -2* preds$se.fit)
with(Prestige, plot(income ,prestige ,xlim=range(income.grid) ,cex =.5, col =" darkgrey ",main='Custom cut Fit'))
lines(income.grid,preds$fit ,lwd =2, col =" blue")
matlines(income.grid ,se.bands ,lwd =1, col =" blue",lty =3)
c(-Inf,10000,max(income))
income
attach(Prestige)
c(-Inf,10000,max(income))
a = c(-Inf,10000,max(income))
a
uneven_breaks
uneven_breaks <- c(seq(0,10000,by=1000),seq(15000,35000,by=10000))
uneven_breaks
m_cut=lm(prestige ~ cut(income,breaks=uneven_breaks),data = Prestige)
income.grid=with(Prestige, seq(range(income)[1],range(income)[2],by=10))
preds=predict(m_cut,list(income=income.grid),se=T)
se.bands=cbind(preds$fit +2* preds$se.fit ,preds$fit -2* preds$se.fit)
with(Prestige, plot(income ,prestige ,xlim=range(income.grid) ,cex =.5, col =" darkgrey ",main='Custom cut Fit'))
lines(income.grid,preds$fit ,lwd =2, col =" blue")
matlines(income.grid ,se.bands ,lwd =1, col =" blue",lty =3)
abline(v=uneven_breaks,lty=2)
summary(m_cut)
uneven_breaks_2 <- c(seq(0,10000,by=100),seq(15000,35000,by=10000))
m_cut2=lm(prestige ~ cut(income,breaks=uneven_breaks_2),data = Prestige)
summary(m_cut2)
library(HoRM)
attach(Prestige)
regressogram(income, prestige, nbins = 10, show.bins = TRUE,
show.means = TRUE, show.lines = TRUE,
x.lab = "Income", y.lab = "Prestige", main = "Binning Regressogram, 10 bins")
knitr::knit_hooks$set(webgl = hook_webgl)
background-color: lightblue;
library(ISLR2)
library(car)
library(mgcv)
library(rgl)
library(splines)
library(pbapply)
```
with(Prestige, scatterplotMatrix(data.frame(prestige, education, income)))
model_lm=lm(prestige ~ education + income, data=Prestige)
summary(model_lm)
education.grid=seq(range(Prestige$education)[1],range(Prestige$education)[2],length.out = 100)
income.grid=seq(range(Prestige$income)[1],range(Prestige$income)[2],length.out = 100)
grid=expand.grid(education.grid,income.grid)
names(grid)=c('education','income')
pred=predict(model_lm,newdata=grid)
persp3d(education.grid,income.grid,pred,col='blue',border="black",lwd=0.3)
with(Prestige, points3d(education,income,prestige,col='black',size=5))
summary(model_lm_interaction)
model_lm_interaction <- lm(prestige ~ education + income + education:income, data=Prestige)
# model_lm_interaction <- lm(prestige ~ education * income, data=Prestige) # alternatively
summary(model_lm_interaction)
persp3d(education.grid,income.grid,pred_interaction,col='grey30')
&=\beta_{0}+f_{1}\left(x_{i 1}\right)+f_{2}\left(x_{i 2}\right)+\cdots+f_{p}\left(x_{i p}\right)+\epsilon_{i}
``{=tex}
model_gam=gam(prestige ~ s(education,bs='cr') + s(income,bs='cr'),data = Prestige)
summary(model_gam)
hist(model_gam$residuals)
qqnorm(model_gam$residuals)
mu.res <- mean(model_gam$residuals)
s.res <- sd(model_gam$residuals)
x <- as.matrix(model_gam$residuals)
y <- as.matrix( rnorm(length(model_gam$residuals), mu.res, sqrt(s.res)) )
DepthProc::ddPlot(x, y,
depth_params = list(method='Tukey'))
shapiro.test(model_gam$residuals)
lm(prestige ~ ns(education, df = 3) + ns(income, df = 3), data = Prestige)
plot(model_gam_ns$residuals,model_gam$residuals)
lm(prestige ~ ns(education, df = 3) + ns(income, df = 3), data = Prestige)
cor(model_gam_ns$residuals,model_gam$residuals)
lm(prestige ~ ns(education, df = 3) + ns(income, df = 3), data = Prestige)
model_gam_ns <-
lm(prestige ~ ns(education, df = 3) + ns(income, df = 3), data = Prestige)
plot(model_gam_ns$residuals,model_gam$residuals)
cor(model_gam_ns$residuals,model_gam$residuals)
plot(model_gam)
plot(model_gam)
plot(model_gam)
par(mfrow=c(1,2))
plot(model_gam)
gam::plot.Gam(model_gam_ns, se=TRUE)
summary(model_gam_reduced)
model_gam_reduced=gam(prestige ~ education + s(income,bs='cr'),data = Prestige)
summary(model_gam_reduced)
N <- nrow(Prestige)
RSS_reduced <- deviance(model_gam_reduced)
RSS_full <- deviance(model_gam)
df_full <- N-sum(summary(model_gam)$s.table[,2])-1 # -1 for the intercept
df_reduced <- N-sum(summary(model_gam_reduced)$s.table[,2])-2 # -2 for the intercept and the linear contribution of education
df_difference <- df_reduced-df_full
F_value_manual <- ((RSS_reduced-RSS_full)/df_difference)/(RSS_full/summary(model_gam)$residual.df)
pf(F_value_manual, df1 = df_difference,df2 = df_full,lower.tail = FALSE)
anova(model_gam_reduced,model_gam, test = "F")
N <- nrow(Prestige)
RSS_reduced <- deviance(model_gam_reduced)
RSS_full <- deviance(model_gam)
df_full <- N-sum(summary(model_gam)$s.table[,2])-1 # -1 for the intercept
df_reduced <- N-sum(summary(model_gam_reduced)$s.table[,2])-2 # -2 for the intercept and the linear contribution of education
df_difference <- df_reduced-df_full
F_value_manual <- ((RSS_reduced-RSS_full)/df_difference)/(RSS_full/summary(model_gam)$residual.df)
pf(F_value_manual, df1 = df_difference,df2 = df_full,lower.tail = FALSE)
pred_gam=predict(model_gam,newdata=grid)
persp3d(education.grid,income.grid,pred_gam,col='grey30')
with(Prestige,points3d(education,income,prestige,col='black',size=5))
s(income, bs ='cr') +
model_gam_inter = gam(prestige ~ s(education, bs = 'cr') +
s(income, bs ='cr') +
s(I(income * education), bs = 'cr'),
data = Prestige)
model_gam_inter = gam(prestige ~ s(education, bs = 'cr') +
s(income, bs ='cr') +
s(I(income * education), bs = 'cr'),
data = Prestige)
pred_inter = predict(model_gam_inter,
newdata = data.frame(grid, inter = grid$education * grid$income))
persp3d(education.grid, income.grid, pred_inter, col = 'grey30')
with(Prestige,
points3d(education, income, prestige, col = 'black', size = 5))
model_gam_tp = gam(prestige ~ s(education, income, bs="tp", m=2), # m for order
data = Prestige)
pred_tp = predict(model_gam_tp,
newdata = data.frame(grid))
plot(model_gam_tp)
x11()
plot(model_gam_tp)
# come interpretare???
plot(model_gam_tp)
# come interpretare???
plot(model_gam_tp)
graphics.off()
# come interpretare???
plot(model_gam_tp)
knitr::opts_chunk$set(cache = TRUE)
library(rgl)
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_chunk$set(cache = TRUE)
knitr::knit_hooks$set(webgl = hook_webgl)
ggplot2::theme_set(ggplot2::theme_bw())
.extracode {
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
lung$ID <- factor(seq(1:nrow(lung)))
lung$status_fact <- factor(lung$status, labels = (c('Censor', 'Event')))
lung_subs <- head(lung)
ggplot(data=lung_subs,aes(x=ID,y=time)) +
geom_bar(stat='identity',width=0.2) +
geom_point(aes(color=status_fact,shape=status_fact),size=6) +
coord_flip()
lung$time
head(lung)
view(lung)
View(lung)
event=lung$status==2) # tell the object which rows have the event
event=lung$status==2) # tell the object which rows have the event
head(Surv(time=lung$time,  # T_i
event=lung$status==2) # tell the object which rows have the event
)
surv(lung$time,lung$status==2)
Surv(lung$time,lung$status==2)
fit <- survfit(Surv(time, status==2) ~ 1, data = lung)
fit
summary(fit)
kable(head(tidy(fit),20))
surv_median(fit)
plot(fit, conf.int = T, xlab='Time [days]', ylab = 'Survival Probability', col='red',
main="Kaplan-Meier Curve for Lung Cancer Survival")
ggsurvplot(fit,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=90,
title="Kaplan-Meier Curve for Lung Cancer Survival")
cumulative_incidence <- 1 - fit$surv
ggsurvplot(fit,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=90,
fun='event',
title="Cumulative Incidence Curve for Lung Cancer Survival")
ggsurvplot(fit,
risk.table = TRUE, # Add risk table
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=90,
fun='cumhaz',
title="Cumulative Hazard Curve for Lung Cancer Survival")
ggsurvplot(fit.age, conf.int = F, risk.table.col = "strata", legend='none')
fit.age <- survfit(Surv(time, status) ~ age, data=lung)
ggsurvplot(fit.age, conf.int = F, risk.table.col = "strata", legend='none')
hist(lung$age, xlab='Age [years]', main='Histogram of age in Lung Cancer Data')
summary(lung$age)
fit.age <- survfit(Surv(time, status) ~ agecat70, data=lung)
lung$agecat70 <- cut(lung$age, breaks=c(0, 70, Inf), labels=c("young", "old"))
fit.age <- survfit(Surv(time, status) ~ agecat70, data=lung)
ggsurvplot(fit.age, conf.int = T,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=90,
legend.labs=c("Young (<= 70)","Old (> 70)"), legend.title="Age class",
palette=c("darkblue","cyan3"),
title="Kaplan-Meier Curves by age class for Lung Cancer Survival")
log_rank_test <- survdiff(Surv(time, status) ~ agecat70, data=lung)
log_rank_test
lung$agecat70 <- cut(lung$age, breaks=c(0, 70, Inf), labels=c("young", "old"))
lung$agecat50 <- cut(lung$age, breaks=c(0, 50, Inf), labels=c("young", "old"))
log_rank_test <- survdiff(Surv(time, status) ~ agecat70, data=lung)
log_rank_test
log_rank_test2 <- survdiff(Surv(time, status) ~ agecat50, data=lung)
log_rank_test2
fit.age <- survfit(Surv(time, status) ~ agecat50, data=lung)
ggsurvplot(fit.age, conf.int = T,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=90,
legend.labs=c("Young (<= 70)","Old (> 70)"), legend.title="Age class",
palette=c("darkblue","cyan3"),
title="Kaplan-Meier Curves by age class for Lung Cancer Survival")
hazard_ratio <- (log_rank_test$obs[1]/log_rank_test$exp[1])/(log_rank_test$obs[2]/log_rank_test$exp[2])
hazard_ratio
cox.age <- coxph(Surv(time, status) ~ age, data = lung)
cox.age
summary(cox.age)
plot(survfit(cox.age, data=lung),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
grid()
age_df <- with(lung,
data.frame(age = c(50,65,80) )
)
fit.age <- survfit(cox.age, newdata = age_df)
fit.age
plot(fit.age, conf.int=T,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('topright', c("Age = 50", "Age = 65", "Age = 80"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
plot(survfit(cox.age, data=lung),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
grid()
plot(fit.age, conf.int=T,
col=c("dodgerblue2","navy","darkmagenta"), lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Adjusted Survival Probability Plot')
grid()
legend('topright', c("Age = 50", "Age = 65", "Age = 80"),
lty=c(1,1,1), lwd=c(2,2,2), col=c("dodgerblue2","navy","darkmagenta"))
glimpse(lung)
lung$sex <- ifelse(lung$sex==1,'Male','Female')
lung$sex <- as.factor(lung$sex)
lung
mod.cox <- coxph(Surv(time, status) ~ age + sex + ph.karno + wt.loss, data =  lung)
summary(mod.cox)
ggforest(mod.cox, data=lung)
grid()
plot(survfit(mod.cox, data=lung),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
grid()
plot(predict(mod.cox), residuals(mod.cox, type='martingale'),
xlab='Fitted values', ylab='Martingale residuals', main='Residual Plot', las=1)
# Add a line for residual=0
abline(h=0, col='red')
# Fit a smoother for the points
lines(smooth.spline(predict(mod.cox), residuals(mod.cox, type='martingale')), col='blue')
ggcoxdiagnostics(mod.cox, type = "deviance")
ggcoxdiagnostics(mod.cox, type = "schoenfeld")
sex.km <- survfit(Surv(time, status) ~ sex, data = lung[!is.na(lung$wt.loss) & !is.na(lung$ph.karno),])
plot(sex.km, fun='cloglog',
col=c("deeppink2","dodgerblue2"), lwd=2, lty=1,
ylab="log(-log(Survival Probability))")
grid()
legend('topleft', c("Female", "Male"),
lty=c(1,1), lwd=c(2,2), col=c("deeppink2","dodgerblue2"))
```
test.ph <- cox.zph(mod.cox)
test.ph
ggcoxdiagnostics(mod.cox, type = "scaledsch")
par(mfrow=c(2,2))
for(i in 1:4){
plot(test.ph[i])
abline(h=0, col='red')
}
ggcoxdiagnostics(mod.cox, type = "scaledsch")
summary(mod.cox.strata)
mod.cox.strata <- coxph(Surv(time, status) ~ age + sex + strata(ph.karno) + wt.loss, data =  lung)
summary(mod.cox.strata)
test.ph.strata <- cox.zph(mod.cox.strata)
test.ph.strata
?strata
?knots
test.ph <- cox.zph(mod.cox)
test.ph
mod.cox.strata <- coxph(Surv(time, status) ~ age + sex + strata(ph.karno) + wt.loss, data =  lung)
summary(mod.cox.strata)
plot(survfit(mod.cox.strata, data=lung),
plot(survfit(mod.cox.strata, data=lung),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
grid()
plot(survfit(mod.cox.strata, data=lung),
col="darkorange2", lwd=2, lty=1,
xlab='Time [days]', ylab='Survival Probability',
main='Baseline estimated survival probability')
grid()
library(readxl)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
setwd("C:/Users/alessandro/Documents/GitHub/NPS_project/Code")
library(readxl)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
View(data)
paesi <- data$Country
paesi
continent <- c("America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "Multinational", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "America", "Europe", "Europe", "America", "Europe", "Europe", "South America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "Europe", "America", "Europe", "Sweden", "Multinational", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "Europe", "Asia", "Europe", "America", "America", "America", "America", "Multinational", "Multinational", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "America", "America", "Asia", "Australia", "America", "America", "America", "America", "America", "Multinational", "Multinational", "America", "America", "America", "America", "Europe", "Asia", "America", "America", "Europe", "America", "Asia", "America", "Multinational", "Multinational", "America", "Multinational", "Asia", "Europe", "America", "Multinational", "America", "Multinational", "America", "America", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "South America", "America", "Asia", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "Europe", "Asia", "Africa", "Multinational", "Asia", "America", "America", "Asia", "Multinational", "Europe", "Asia", "America", "America", "Asia", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Asia", "Europe", "America", "America", "Europe", "Asia", "America", "Asia", "Multinational", "South America", "America", "America", "Europe", "Asia", "America", "Multinational", "America", "America", "Asia", "Europe", "America", "America", "America", "Europe", "Europe", "Europe", "Europe", "America", "Europe", "Asia", "Asia", "Europe", "Europe", "Asia", "Asia", "Asia", "Europe", "Asia", "Asia", "America", "Europe", "Multinational", "America", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Europe", "Asia", "Europe", "Asia", "Multinational", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "America", "America")
"America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "Multinational", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "America", "Europe", "Europe", "America", "Europe", "Europe", "South America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "Europe", "America", "Europe", "Sweden", "Multinational", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "Europe", "Asia", "Europe", "America", "America", "America", "America", "Multinational", "Multinational", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "America", "America", "Middle East", "Australia", "America", "America", "America", "America", "America", "Multinational", "Multinational", "America", "America", "America", "America", "Europe", "Asia", "America", "America", "Europe", "America", "Asia", "America", "Multinational", "Multinational", "America", "Multinational", "Asia", "Europe", "America", "Multinational", "America", "Multinational", "America", "America", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "South America", "America", "Asia", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "Europe", "Asia", "Africa", "Multinational", "Asia", "America", "America", "Asia", "Multinational", "Europe", "Asia", "America", "America", "Asia", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Asia", "Europe", "America", "America", "Europe", "Asia", "America", "Asia", "Multinational", "South America", "America", "America", "Europe", "Asia", "America", "Multinational", "America", "America", "Asia", "Europe", "America", "America", "America", "Europe", "Europe", "Europe", "Europe", "America", "Europe", "Asia", "Asia", "Europe", "Europe", "Asia", "Asia", "Asia", "Europe", "Asia", "Asia", "America", "Europe", "Multinational", "America", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Europe", "Asia", "Europe", "Asia", "Multinational", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "America", "America", "America", "America", "America", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Russia", "America", "Europe", "Europe", "Europe", "United Kingdom", "America", "Asia", "America"
cont <-  c("America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "Multinational", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "America", "America", "Europe", "America", "America", "America", "Europe", "Europe", "America", "Europe", "Europe", "South America", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "America", "Europe", "America", "Europe", "Sweden", "Multinational", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "Europe", "Asia", "Europe", "America", "America", "America", "America", "Multinational", "Multinational", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "America", "America", "Middle East", "Australia", "America", "America", "America", "America", "America", "Multinational", "Multinational", "America", "America", "America", "America", "Europe", "Asia", "America", "America", "Europe", "America", "Asia", "America", "Multinational", "Multinational", "America", "Multinational", "Asia", "Europe", "America", "Multinational", "America", "Multinational", "America", "America", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "South America", "America", "Asia", "Multinational", "Multinational", "Multinational", "Europe", "America", "America", "America", "America", "Europe", "Europe", "America", "America", "America", "America", "America", "Europe", "Asia", "Africa", "Multinational", "Asia", "America", "America", "Asia", "Multinational", "Europe", "Asia", "America", "America", "Asia", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Asia", "Europe", "America", "America", "Europe", "Asia", "America", "Asia", "Multinational", "South America", "America", "America", "Europe", "Asia", "America", "Multinational", "America", "America", "Asia", "Europe", "America", "America", "America", "Europe", "Europe", "Europe", "Europe", "America", "Europe", "Asia", "Asia", "Europe", "Europe", "Asia", "Asia", "Asia", "Europe", "Asia", "Asia", "America", "Europe", "Multinational", "America", "Asia", "Asia", "Asia", "America", "Asia", "Europe", "Europe", "Asia", "Europe", "Asia", "Multinational", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Europe", "America", "Europe", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "America", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "America", "America", "America", "America", "America", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "America", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Asia", "Russia", "America", "Europe", "Europe", "Europe", "United Kingdom", "America", "
Asia", "America")
library(countrycode)
install.packages("countrycode")
library(countrycode)
dataframe_paesi <- data.frame(paese = paesi)
dataframe_paesi$continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "iso2c", destination = "continent")
View(dataframe_paesi)
class(paesi)
dataframe_paesi$continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "iso2c", destination = "continent", custom_match = data.frame(iso2c = c("NonEsistente"), continent = c("NA")))
paesi <- c("USA", "United Kingdom", "France", "China", "India")
dataframe_paesi <- data.frame(paese = paesi)
dataframe_paesi$continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "iso2c", destination = "continent")
library(readxl)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
paesi <- data$Country
dataframe_paesi <- data.frame(paese = paesi)
library(countrycode)
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "iso2c", destination = "continent")
View(dataframe_paesi)
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "iso3c", destination = "continent")
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "wb", destination = "continent")
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "country.name", destination = "continent")
continente+
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "country.name", destination = "continent")
continente
esa <- which(paesi == 'ESA')
multinat <- which(paesi == 'Multinational')
continente[esa] == 'Europe'
continente[esa] = 'Europe'
continente[multinat] = 'Multinational'
continente
data <- cbind(data,Continent = continente)
View(data)
save(data, "Data_new")
save(data, file ="Data_new")
save(data, file ="Data_new.Rdata")
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
paesi <- data$Country
setwd("C:/Users/alessandro/Documents/GitHub/NPS_project/Src")
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
library(readxl)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
paesi <- data$Country
# Carica il pacchetto
#install.packages("countrycode")
library(countrycode)
# Crea un dataframe di esempio con i paesi
dataframe_paesi <- data.frame(paese = paesi)
esa <- which(paesi == 'ESA')
multinat <- which(paesi == 'Multinational')
# Usa la funzione countrycode per ottenere il continente
continente <- countrycode(sourcevar = dataframe_paesi$paese, origin = "country.name", destination = "continent")
continente[esa] = 'Europe'
continente[multinat] = 'Multinational
data <- cbind(data,Continent = continente)
data <- cbind(data,Continent = continente)
data <- cbind(data,Continent = continente)
d
continente[esa] = 'Europe'
data <- cbind(data,Continent = continente)
View(data)
continente[esa] = 'Europe'
continente[multinat] = 'Multinational
continente[multinat] = 'Multinational'
continente[multinat] = 'Multinational'
data <- cbind(data,Continent = continente)
save(data, file ="Data_new.Rdata")
save(data, file ="Data_Satellites.xlsx")
View(data)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
data <- cbind(data,Continent = continente)
View(data)
install.packages("openxlsx")
library(openxlsx)
write.xlsx(data, file = 'Data_Satellites.xlsx', rowNames = FALSE)
# per lettura dataset se prendi file da github
library(readxl)
data <- read_excel("../Dataset/Data_Satellites.xlsx", col_names = TRUE)
library(readxl)
library(survival)
library(survminer)
library(dplyr)
library(ggplot2)
library(knitr)
library(broom)
library(tidyr)
data <- data[sample(nrow(data)), ]
data$ID <- factor(seq(1:nrow(data)))
data_subs <- head(data)
time <- data_subs$'Effective Lifetime'
ggplot(data=data_subs,aes(x=ID,y=time)) +
geom_bar(stat='identity',width=0.2) +
geom_point(aes(color=Status,shape=Status),size=6) +
coord_flip()
head(Surv(time=data$'Effective Lifetime',  # T_i
event=data$Status == 'retired') # tell the object which rows have the event
)
time <- data$'Effective Lifetime'
fit <- survfit(Surv(time,Status == 'retired') ~ 1, data = data)
summary(fit)
kable(head(tidy(fit),20))
surv_median(fit) #not reached
ggsurvplot(fit, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival")
View(data)
cumulative_incidence <- 1 - fit$surv
ggsurvplot(fit, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata", # Change risk table color by groups
surv.median.line = "hv", # Specify median survival
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
fun='event',
title="Cumulative Incidence Curve")
ggsurvplot(fit, data = data,
risk.table = TRUE, # Add risk table
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
fun='cumhaz',
title="Cumulative Hazard Curve for Satellites Survival")
fit.Continent <- survfit(Surv(time,Status == 'retired') ~ Continent, data=data)
ggsurvplot(fit.Users, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
fit.Continent <- survfit(Surv(time,Status == 'retired') ~ Continent, data=data)
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
x11()
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
x11()
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
x11()
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
windows()
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
fit.Continent <- survfit(Surv(time,Status == 'retired') ~ Continent, data=data)
ggsurvplot(fit.Continent, data = data,
risk.table = TRUE, # Add risk table
risk.table.col = "strata",
ggtheme = theme_bw(), # Change ggplot2 theme
break.time.by=5,
title="Kaplan-Meier Curve for Satellites Survival by Continent")
log_rank_test <- survdiff(Surv(time, Status == 'retired') ~ Continent, data=data)
log_rank_test
