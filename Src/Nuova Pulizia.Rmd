---
title: "Nuova Pulizia"
output: html_document
date: "2023-11-30"
---


Set wd:
```{r}
setwd("C:/Users/simon/OneDrive/Documenti/GitHub/NPS_project/Src")
```

Import data:
```{r}
data <- read.csv("satcat.csv", header = TRUE)
```

Nomi colonne:
```{r}
names(data)
```
Rimozione colonne inutili:
```{r}
columns_to_remove <- c("OBJECT_NAME", "OBJECT_ID", "NORAD_CAT_ID", "OBJECT_TYPE", "LAUNCH_SITE","RCS", "DATA_STATUS_CODE", "ORBIT_CENTER", "ORBIT_TYPE")

data <- data[, -c(which(names(data) %in% columns_to_remove))]

names(data)
```

Tieni solo satelliti Nonoperational(-) o decayed(D)
```{r}
data <- data[which(data$OPS_STATUS_CODE == "-" | data$OPS_STATUS_CODE == "D"),]
```

Numero di NA in ogni colonna
```{r}
df <- data.frame()

for (colonna in colnames(data)) {
    conteggio_na <- sum(is.na(data[[colonna]]))
    df <- rbind(df, data.frame(Colonna = colonna, Numero_di_NA = conteggio_na))
}

df
```

Rimuoviamo righe con NA
```{r}
cols <- c("PERIOD", "INCLINATION", "APOGEE", "PERIGEE")

data <- data[complete.cases(data[, cols]), ]
```


```{r}
summary(data)
```
Facciamo finta di non aver visto gli outliers


Rendi colonne factor:
```{r}
data$'OPS_STATUS_CODE' <- factor(data$OPS_STATUS_CODE, ordered = F)
print('OPS_STATUS_CODE')
table(data$OPS_STATUS_CODE)

data$OWNER <- factor(data$OWNER, ordered = F)
print('OWNER')
table(data$OWNER)
```
Togli stringe vuote delle date:
```{r}
data <- subset(data, LAUNCH_DATE != "")
data <- subset(data, DECAY_DATE != "")
```

Calcolo effective lifetime:

Trasformare le date in POSICxt
```{r}
data$LAUNCH_DATE <- as.Date(data$LAUNCH_DATE)
data$DECAY_DATE <- as.Date(data$DECAY_DATE)

# Convertire la data in un oggetto di classe POSIXct
data$LAUNCH_DATE <- as.POSIXct(data$LAUNCH_DATE)
data$DECAY_DATE <- as.POSIXct(data$DECAY_DATE)
```

Calcolo Effective Lifetime
```{r}
data$`Effective Lifetime` <- round(as.numeric(data$DECAY_DATE - data$LAUNCH_DATE)/(365 * 24 * 60 * 60), digit = 2)
data$`Effective Lifetime`
```

Elimina dal dataset righe con lifetime inferiori ad un anno o piÃ¹

```{r}
data <- data[which(data$`Effective Lifetime` > 1),]
# data <- data[which(data$`Effective Lifetime` > 10),]
data$`Effective Lifetime`
```

Esportazione dataset
```{r}
# Caricare la libreria
library(openxlsx)
# Specificare il percorso del file Excel
percorso_file_excel <- "C:/Users/simon/OneDrive/Documenti/GitHub/NPS_project/Src"

# Scrivere il dataframe nel file Excel
write.xlsx(data, percorso_file_excel, rowNames = FALSE)
```
