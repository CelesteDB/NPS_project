---
title: "NPS Project"
author: "Simone Ciardulli"
date: "`r Sys.Date()`"
output: html_document
---

Set wd:
```{r}
setwd("C:/Users/simon/Desktop/Università/V Anno/I Semester/Nonparametric Statistics/Project")
```

Import data
```{r}
library(readxl)
data <- read_excel("UCS-Satellite-Database-1-1-2023.xlsx", col_names = TRUE)
```

Column names:
```{r}
names(data)
```


```{r}
columns_to_remove <- c("Name of Satellite, Alternate Names", "Country of Operator/Owner", "Operator/Owner", "Detailed Purpose", "Type of Orbit", "Contractor", "Launch Site", "Launch Vehicle", "COSPAR Number", "NORAD Number", "Comments", "...32", "Source Used for Orbital Data", "Source...34", "Source...35", "Source...36", "Source...37", "Source...38", "Source...39", "Source...40")

data <- data[, -c(which(names(data) %in% columns_to_remove), 41:71)]

names(data)
```

Confronta "Country of Contractor" con "Country/Org of UN Registry":
```{r}
ind <- which(data$`Country of Contractor` != data$`Country/Org of UN Registry`)

cc <- data$`Country of Contractor`[ind]
cr <- data$`Country/Org of UN Registry`[ind]

df <- data.frame(cr, cc)
df
```
1956 diversi, io terrei country of registry
```{r}
data <- data[, -which(names(data) == "Country of Contractor")]
```


Numero di NA in ogni colonna
```{r}
df <- data.frame()

for (colonna in colnames(data)) {
    conteggio_na <- sum(is.na(data[[colonna]]))
    df <- rbind(df, data.frame(Colonna = colonna, Numero_di_NA = conteggio_na))
}

df
```

Dry Mass ha 6275 NA, la toglierei
Power ha 6137 NA, la toglierei
```{r}
columns_to_remove <- c("Dry Mass (kg.)", "Power (watts)")

data <- data[, -which(names(data) %in% columns_to_remove)]
```



Expected Lifetime (yrs.) ha 1915 NA, toglierei le righe senza questo dato
Date of Launch ha 2 NA, toglierei le righe senza questo dato
Launch Mass (kg.) ha 244 NA, toglierei le righe senza questo dato
Period ha 45 NA, toglierei le righe senza questo dato
Inclination (degrees) ha 3 NA, toglierei le righe senza questo dato
Eccentricity ha 1 NA, toglierei le righe senza questo dato
Apogee ha 1 NA, toglierei le righe senza questo dato
Perigree ha 1 NA, toglierei le righe senza questo dato
Longitude of GEO ha 2 NA, toglierei le righe senza questo dato

```{r}
cols <- c("Expected Lifetime (yrs.)", "Date of Launch", "Launch Mass (kg.)", "Period (minutes)", "Inclination (degrees)", "Eccentricity", "Apogee (km)", "Perigee (km)", "Longitude of GEO (degrees)")

data <- data[complete.cases(data[, cols]), ]
```

Numero di NA in ogni colonna
```{r}
df <- data.frame()

for (colonna in colnames(data)) {
    conteggio_na <- sum(is.na(data[[colonna]]))
    df <- rbind(df, data.frame(Colonna = colonna, Numero_di_NA = conteggio_na))
}

df
```

Colonne sopravvissute:
```{r}
names(data)
```

Rendi colonne factor:
```{r}
data$'Country/Org of UN Registry' <- factor(data$'Country/Org of UN Registry', ordered = F)
print('Country/Org of UN Registry')
table(data$'Country/Org of UN Registry')

data$Users <- factor(data$Users, ordered = F)
print('Users')
table(data$Users)

data$Purpose <- factor(data$Purpose, ordered = F)
print('Purpose')
table(data$Purpose)

data$'Class of Orbit' <- factor(data$'Class of Orbit', ordered = F)
print('Class of Orbit')
table(data$'Class of Orbit')

data$Status <- factor(data$Status, ordered = F)
print('Status')
table(data$Status)
```

Stati NR

Doppie classi per users e purpose




Ispezione del dataset:
```{r}
summary(data)
```

Esportazione dataset
```{r}
# Caricare la libreria
library(openxlsx)
# Specificare il percorso del file Excel
percorso_file_excel <- "C:/Users/simon/Desktop/Università/V Anno/I Semester/Nonparametric Statistics/Project"

# Scrivere il dataframe nel file Excel
write.xlsx(data, percorso_file_excel, rowNames = FALSE)
```

